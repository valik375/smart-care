let currentTemplate,selectedSpace,selectedFunctions,calculatorSections=[{sectionType:"choose",title:"Який <span>тип приміщення</span> потребує системи розумного будинку?",text:"Ця інформація допоможе нам підібрати ідеальні рішення, які відповідатимуть особливостям вашого приміщення.",variants:[{text:"Квартира",label:"flat",icon:"../assets/white-flat.svg",selected:!1},{text:"Приватний будинок",label:"house",icon:"../assets/white-house.svg",selected:!1},{text:"Офіс",label:"office",icon:"../assets/white-case.svg",selected:!1}]},{sectionType:"choose",title:"Які <span>функції безпеки</span> повинні бути у вашому розумному будинку?",text:"Оберіть необхідні функції безпеки. Кількість необмежена.",subtext:"Не знайшли потрібної функції? Вкажіть її при телефонній розмові або переписці з нами та ми обовʼязково додамо її для вас.",variants:[{text:"Захист від <br>вторгнення",label:"protectionAgainstIntrusion",icon:"../assets/white-balaclava.svg",price:{flat:300,house:300,office:300},selected:!1},{text:"Система <br>відеоспостереження",label:"videoSurveillanceSystem",icon:"../assets/white-camera.svg",price:{flat:400,house:400,office:400},selected:!1},{text:"Імітація <br>присутності",label:"imitationOfPresence",icon:"../assets/white-user.svg",price:{flat:300,house:300,office:300},roomType:["bedroom"],selected:!1},{text:"Інтеграція зі <br>службою охорони",label:"integrationWithTheSecurityService",icon:"../assets/white-shield.svg",price:{flat:130,house:130,office:130},selected:!1},{text:"Розумні замки",label:"smartLocks",icon:"../assets/white-lock.svg",price:{flat:600,house:600,office:600},selected:!1},{text:"Протипожежна <br>система",label:"fireProtectionSystem",icon:"../assets/white-fire.svg",price:{flat:250,house:250,office:250},selected:!1},{text:"Антипотоп система",label:"antiFloodSystem",icon:"../assets/white-drop.svg",price:{flat:150,house:150,office:350},roomType:["kitchen","bathroom"],selected:!1}]},{sectionType:"choose",title:"Які <span>функції комфорту</span> повинні бути у вашому розумному будинку?",text:"Оберіть необхідні функції комфорту. Кількість необмежена.",subtext:"Не знайшли потрібної функції? Вкажіть її при телефонній розмові або переписці з нами та ми обовʼязково додамо її для вас.",variants:[{text:"Контроль <br>освітлення",label:"controlOfLighting",icon:"../assets/white-light.svg",price:{flat:175,house:175,office:75},roomType:["kitchen","bedroom","bathroom"],selected:!1},{text:"Клімат-контроль",label:"climateControl",icon:"../assets/white-temperature.svg",price:{flat:500,house:500,office:500},selected:!1},{text:"Автоматичні ролети",label:"automaticDoorsAndRollerShutters",icon:"../assets/white-blinds.svg",price:{flat:400,house:400,office:400},roomType:["bedroom"],selected:!1},{text:"Автоматизація <br>ветниляції",label:"automationOVetting",icon:"../assets/white-wentilation.svg",price:{flat:70,house:70,office:70},roomType:["kitchen","bathroom"],selected:!1},{text:"Керування системами <br>опалення",label:"managementOfHeatingSystems",icon:"../assets/white-heating.svg",price:{flat:75,house:75,office:75},roomType:["bedroom","livingRoom"],selected:!1},{text:"Голосовий <br>ассистент",label:"voiceAssistant",icon:"../assets/white-micro.svg",price:{flat:200,house:200,office:200},selected:!1},{text:"Розумний <br>прибиральник",label:"smartCleaner",icon:"../assets/white-robot.svg",price:{flat:50,house:50,office:50},selected:!1}]},{sectionType:"rooms",title:"Які <span>кімнати</span> потребують системи розумного будинку?",text:"Оберіть тип кімнат та їх кількість. Завдяки цьому ми підрахуємо вартість саме для вашого випадку.",rooms:[{id:0,name:"Кухня",label:"kitchen",value:1},{id:1,name:"Санвузол",label:"bathroom",value:1},{id:2,name:"Вітальня/коридор/лоджія",label:"livingRoom",value:1},{id:3,name:"Спальня",label:"bedroom",value:1},{id:4,name:"Нежилі, технічні <br> приміщення тощо",label:"etc",value:1}]},{sectionType:"range",title:"Яка площина <span>вашого</span> приміщення?",text:"Від площини приміщення залежить кількість та тип пристроїв системи розумного будинку.",rangeValue:40,label:"SizeOfFlat"}],currentStep=0,totalPrice=0,securityFunctions=0,comfortFunctions=0,securityFunctionsText=[],comfortFunctionsText=[];const calculatorModalBody=document.querySelector(".calculator-modal__body"),prevButton=document.querySelector(".calculator-modal__back"),nextButton=document.querySelector(".calculator-modal__next"),calculatorModalBackdrop=document.querySelector(".calculator-modal__backdrop"),chooseFlatHandler=a=>{document.querySelectorAll(".calculator-modal__template-choose-item").forEach(((l,t)=>{t===a?l.classList.add("selected"):l.classList.remove("selected")})),currentTemplate.variants.map(((l,t)=>{l.selected=t===a}))},chooseHandler=a=>{document.querySelectorAll(".calculator-modal__template-choose-item")[a].classList.toggle("selected"),currentTemplate.variants[a].selected=!currentTemplate.variants[a].selected},chooseVariant=a=>{0===currentStep?chooseFlatHandler(a):chooseHandler(a)},chooseTemplate=a=>`\n    <div class="calculator-modal__template choose">\n      <h2 class="calculator-modal__template-title">${a.title}</h2>\n      <p class="calculator-modal__template-text text">${a.text}</p>\n      <div class="calculator-modal__template-choose">\n      ${a.variants.map(((a,l)=>`\n          <div onclick="chooseVariant(${l})" class="calculator-modal__template-choose-item ${a.selected?"selected":""}">\n            <img src="${a.icon}" alt="${a.text}">\n            <span>${a.text}</span>\n          </div>\n        `)).join("")}\n      </div>\n      ${a.subtext?`<div class="calculator-modal__template-choose-subtext text">${a.subtext}</div>`:""}\n\n    </div>\n  `,decrementRoom=(a,l)=>{currentTemplate.rooms[l].value<=0||(currentTemplate.rooms[l].value-=1,a.target.nextElementSibling.innerHTML=currentTemplate.rooms[l].value)},incrementRoom=(a,l)=>{currentTemplate.rooms[l].value+=1,a.target.previousElementSibling.innerHTML=currentTemplate.rooms[l].value},roomsTemplate=a=>`\n    <div class="calculator-modal__template rooms">\n      <h2 class="calculator-modal__template-title">${a.title}</h2>\n      <p class="calculator-modal__template-text text">${a.text}</p>\n      <div class="calculator-modal__template-rooms">\n        ${a.rooms.map(((a,l)=>`\n            <div class="calculator-modal__template-room">\n              <div class="calculator-modal__template-room__name">${a.name}</div>\n              <div class="calculator-modal__template-counter">\n                <button onclick="decrementRoom(event, ${l})" class="calculator-modal__template-minus" type="button">-</button>\n                <div class="calculator-modal__template-room-value">${a.value}</div>\n                <button onclick="incrementRoom(event, ${l})" class="calculator-modal__template-plus" type="button">+</button>\n              </div>\n            </div>\n          `)).join("")}\n      </div>\n    </div>\n  `,changeInputRange=a=>{document.querySelector(".calculator-modal__range input").value=a.target.value,currentTemplate.rangeValue=a.target.value},changeRange=a=>{document.querySelector(".calculator-modal__range-value").value=a.target.value,currentTemplate.rangeValue=a.target.value},rangeTemplate=a=>`\n    <div class="calculator-modal__template range">\n      <h2 class="calculator-modal__template-title">${a.title}</h2>\n      <p class="calculator-modal__template-text text">${a.text}</p>\n      <div class="calculator-modal__range-wrapper">\n        <div class="input-group">\n          <input\n            type="text"\n            class="calculator-modal__range-value input"\n            value="${a.rangeValue}"\n            pattern="[0-9]+"\n            max="200"\n            onchange="changeInputRange(event)"\n          >\n          <span class="calculator-modal__label">m²</span>\n        </div>\n        <div class="calculator-modal__range">\n          <input \n            type="range" \n            value="${a.rangeValue}"\n            min="10" \n            max="200" \n            onchange="changeRange(event)"\n          >\n          <div class="calculator-modal__range-splitter left"></div>\n          <div class="calculator-modal__range-splitter center"></div>\n          <div class="calculator-modal__range-splitter right"></div>\n          <div class="calculator-modal__range-values">\n            <div class="calculator-modal__range-value">10</div>\n            <div class="calculator-modal__range-value">100</div>\n            <div class="calculator-modal__range-value">200</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `,removeBrFromText=a=>a.replace(/\<br\>/g,""),setFunctions=(a,l,t,e)=>{0===a?(securityFunctions+=l,securityFunctionsText.push(`${e} ${t}шт.`)):(comfortFunctions+=l,comfortFunctionsText.push(`${e} ${t}шт.`))},calculate=()=>{selectedSpace=calculatorSections[0].variants.find((a=>a.selected));const a=selectedSpace.label,l=calculatorSections[3].rooms,t=calculatorSections[4].rangeValue;selectedFunctions=[calculatorSections[1],calculatorSections[2]].map(((e,n)=>e.variants.map((e=>{if(e.selected){if(e.roomType?.length){const o=l.filter((a=>e.roomType.includes(a.label)));let c=0,i=!!o.find((a=>"kitchen"===a.label));o.forEach((a=>{c+=a.value})),c=0!==c?c:1;let d=c*e.price[a];return t>=80&&"controlOfLighting"===e.label&&(d+=300),"underfloorHeating"===e.label&&i&&(d+=100),setFunctions(n,d,c,e.text),{text:removeBrFromText(e.text),label:e.label,quantity:c,price:d}}let o=e.price[a];return"office"===a&&t>=100&&"voiceAssistant"===e.label&&(o*=2),setFunctions(n,o,1,e.text),{text:removeBrFromText(e.text),label:e.label,quantity:1,price:o}}return null})).filter((a=>null!==a)))),totalPrice=700+securityFunctions+comfortFunctions},formTemplate=()=>(calculate(),`\n   <div class="calculator-modal_final">\n      <div class="calculator-modal_final-title">Готово! Орієнтована вартість вашого розумного будинку:</div>\n      <div class="calculator-modal_final-dropdown">\n        <div class="calculator-modal_final-dropdown-header">\n          <div class="calculator-modal_final-dropdown-left">\n            <div class="calculator-modal_final-dropdown-title total">~ $${totalPrice}</div>\n            <div class="calculator-modal_final-dropdown-icon">\n              <img src="../assets/gray-information.svg" alt="Icon">\n              <div class="calculator-modal_final-info">\n                <svg xmlns="http://www.w3.org/2000/svg" width="13" height="5" viewBox="0 0 13 5" fill="none">\n                  <path d="M12.5 5L7.95308 1.08768C7.2209 0.457695 6.1431 0.440996 5.39176 1.048L0.5 5L12.5 5Z" fill="#2E3038"/>\n                </svg>\n                Ціна розрахована на основі необхідного мінімуму для обраних функцій, \n                типу та кількості кімнат. Наприклад, якщо у будинку одна ванна кімната \n                та одна кухня, системі антипотопу у базі необхідно 2 датчика води \n                (по одному у кожну з кімнат).\n              </div>\n            </div>\n          </div>\n          <div class="calculator-modal_final-dropdown-right">\n            <span>Детальні розрахунки</span>\n            <img src="../assets/min-white-arrow-right.svg" alt="Arrow icon">\n          </div>\n        </div>\n        <div class="calculator-modal_final-dropdown-body">\n  \n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Smart Hub</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Пристрій, що буде керувати усіма системами та датчиками.</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$220</div>\n          </div>\n          ${0===securityFunctions?"":`\n               <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Безпека та захист</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${securityFunctionsText.map((a=>a)).join(" ")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${securityFunctions}</div>\n              </div>\n            `}\n          ${0===comfortFunctions?"":`\n              <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Комфорт та продуктивність</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${comfortFunctionsText.map((a=>a)).join(" ,")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${comfortFunctions}</div>\n              </div>\n            `}\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Проектування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Ми узгодимо з вами функції та бюджет і спроектуємо систему та\n                розміщення вузлів розумного будинку. </div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$110</div>\n          </div>\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Монтаж та налаштування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Після схвалення проекту розумного будинку ми встановимо все необхідне\n                обладнання та програмне забезпечення, а також надамо вам детальні інструкції щодо його використання. Вам залишається займатися\n                своїми справами, поки розумний будинок виконує все за вас!</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$290-560</div>\n          </div>\n  \n        </div>\n      </div>\n      <p class="calculator-modal_final-text text">Вище наведена лише орієнтована вартість. Вона залежить у першу\n        чергу від виробників пристроїв, бажаних сценаріїв автоматизації, а також складності встановлення\n        обладнання. Ми можемо змінювати вказану суму, адаптуючи її під ваші потреби та можливості, для цього\n        достатньо лише зв'язатися з нами!</p>\n  \n      <form class="calculator-modal_final-form">\n        <div class="calculator-modal_final-form-title">Залиште свій контакт, щоб детальніше дізнатись про встановлення Розумного дому</div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="name" class="label">Імʼя*</label>\n          <input\n            id="name"\n            name="Iмʼя"\n            type="text"\n            class="input"\n            placeholder="Введіть ваше імʼя"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="phone" class="label">Телефон*</label>\n          <input\n            class="input"\n            id="phone"\n            name="Телефон"\n            value="+380"\n            placeholder="+380XXXXXXXXX"\n            type="tel"\n            maxlength="13"\n            pattern="^\\+380[0-9]{9}$"\n            title="Введіть данні в форматі +380XXXXXXXXX"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="email" class="label">Email</label>\n          <input\n            class="input"\n            id="email"\n            name="Email"\n            type="email"\n            placeholder="Введіть ваш email"\n          >\n        </div>\n        <button class="calculator-modal_final-form-submit button blue" type="submit">Звʼяжіться зі мною</button>\n      </form>\n    </div>\n  `),finalStepSetup=()=>{calculatorModalBody.innerHTML=(calculate(),`\n   <div class="calculator-modal_final">\n      <div class="calculator-modal_final-title">Готово! Орієнтована вартість вашого розумного будинку:</div>\n      <div class="calculator-modal_final-dropdown">\n        <div class="calculator-modal_final-dropdown-header">\n          <div class="calculator-modal_final-dropdown-left">\n            <div class="calculator-modal_final-dropdown-title total">~ $${totalPrice}</div>\n            <div class="calculator-modal_final-dropdown-icon">\n              <img src="../assets/gray-information.svg" alt="Icon">\n              <div class="calculator-modal_final-info">\n                <svg xmlns="http://www.w3.org/2000/svg" width="13" height="5" viewBox="0 0 13 5" fill="none">\n                  <path d="M12.5 5L7.95308 1.08768C7.2209 0.457695 6.1431 0.440996 5.39176 1.048L0.5 5L12.5 5Z" fill="#2E3038"/>\n                </svg>\n                Ціна розрахована на основі необхідного мінімуму для обраних функцій, \n                типу та кількості кімнат. Наприклад, якщо у будинку одна ванна кімната \n                та одна кухня, системі антипотопу у базі необхідно 2 датчика води \n                (по одному у кожну з кімнат).\n              </div>\n            </div>\n          </div>\n          <div class="calculator-modal_final-dropdown-right">\n            <span>Детальні розрахунки</span>\n            <img src="../assets/min-white-arrow-right.svg" alt="Arrow icon">\n          </div>\n        </div>\n        <div class="calculator-modal_final-dropdown-body">\n  \n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Smart Hub</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Пристрій, що буде керувати усіма системами та датчиками.</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$220</div>\n          </div>\n          ${0===securityFunctions?"":`\n               <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Безпека та захист</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${securityFunctionsText.map((a=>a)).join(" ")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${securityFunctions}</div>\n              </div>\n            `}\n          ${0===comfortFunctions?"":`\n              <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Комфорт та продуктивність</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${comfortFunctionsText.map((a=>a)).join(" ,")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${comfortFunctions}</div>\n              </div>\n            `}\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Проектування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Ми узгодимо з вами функції та бюджет і спроектуємо систему та\n                розміщення вузлів розумного будинку. </div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$110</div>\n          </div>\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Монтаж та налаштування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Після схвалення проекту розумного будинку ми встановимо все необхідне\n                обладнання та програмне забезпечення, а також надамо вам детальні інструкції щодо його використання. Вам залишається займатися\n                своїми справами, поки розумний будинок виконує все за вас!</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$290-560</div>\n          </div>\n  \n        </div>\n      </div>\n      <p class="calculator-modal_final-text text">Вище наведена лише орієнтована вартість. Вона залежить у першу\n        чергу від виробників пристроїв, бажаних сценаріїв автоматизації, а також складності встановлення\n        обладнання. Ми можемо змінювати вказану суму, адаптуючи її під ваші потреби та можливості, для цього\n        достатньо лише зв'язатися з нами!</p>\n  \n      <form class="calculator-modal_final-form">\n        <div class="calculator-modal_final-form-title">Залиште свій контакт, щоб детальніше дізнатись про встановлення Розумного дому</div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="name" class="label">Імʼя*</label>\n          <input\n            id="name"\n            name="Iмʼя"\n            type="text"\n            class="input"\n            placeholder="Введіть ваше імʼя"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="phone" class="label">Телефон*</label>\n          <input\n            class="input"\n            id="phone"\n            name="Телефон"\n            value="+380"\n            placeholder="+380XXXXXXXXX"\n            type="tel"\n            maxlength="13"\n            pattern="^\\+380[0-9]{9}$"\n            title="Введіть данні в форматі +380XXXXXXXXX"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="email" class="label">Email</label>\n          <input\n            class="input"\n            id="email"\n            name="Email"\n            type="email"\n            placeholder="Введіть ваш email"\n          >\n        </div>\n        <button class="calculator-modal_final-form-submit button blue" type="submit">Звʼяжіться зі мною</button>\n      </form>\n    </div>\n  `),document.querySelector(".calculator-modal__card").classList.add("final-step"),document.querySelector(".calculator-modal_final-dropdown-header").addEventListener("click",(()=>{document.querySelector(".calculator-modal_final-dropdown").classList.toggle("active")})),document.querySelector(".calculator-modal_final-form").addEventListener("submit",(async a=>{a.preventDefault();const l=new FormData(a.target),t=[...selectedFunctions[0],...selectedFunctions[1]],e=calculatorSections[3].rooms;l.append("Тип приміщення:",selectedSpace.text),l.append("Приблизна вартiсть:",`$${totalPrice}`),l.append("Функції безпеки вартiсть:",`$${securityFunctions}`),l.append("Функції комфорту вартiсть:",`$${comfortFunctions}`),l.append("Функції"," "),t.map((a=>{l.append(a.text,a.quantity)})),l.append("Кімнати"," "),e.map((a=>{l.append(removeBrFromText(a.name),a.value)}));try{await fetch("https://formspree.io/f/mvojazwd",{method:"POST",body:l,headers:{Accept:"application/json"}}),a.target.reset(),document.querySelector(".confirm-modal__backdrop").classList.add("visible")}catch(a){console.log(a)}}))},renderStep=()=>{let a;if(currentTemplate=calculatorSections[currentStep],currentStep>=5)return calculatorModalBody.innerHTML=(calculate(),`\n   <div class="calculator-modal_final">\n      <div class="calculator-modal_final-title">Готово! Орієнтована вартість вашого розумного будинку:</div>\n      <div class="calculator-modal_final-dropdown">\n        <div class="calculator-modal_final-dropdown-header">\n          <div class="calculator-modal_final-dropdown-left">\n            <div class="calculator-modal_final-dropdown-title total">~ $${totalPrice}</div>\n            <div class="calculator-modal_final-dropdown-icon">\n              <img src="../assets/gray-information.svg" alt="Icon">\n              <div class="calculator-modal_final-info">\n                <svg xmlns="http://www.w3.org/2000/svg" width="13" height="5" viewBox="0 0 13 5" fill="none">\n                  <path d="M12.5 5L7.95308 1.08768C7.2209 0.457695 6.1431 0.440996 5.39176 1.048L0.5 5L12.5 5Z" fill="#2E3038"/>\n                </svg>\n                Ціна розрахована на основі необхідного мінімуму для обраних функцій, \n                типу та кількості кімнат. Наприклад, якщо у будинку одна ванна кімната \n                та одна кухня, системі антипотопу у базі необхідно 2 датчика води \n                (по одному у кожну з кімнат).\n              </div>\n            </div>\n          </div>\n          <div class="calculator-modal_final-dropdown-right">\n            <span>Детальні розрахунки</span>\n            <img src="../assets/min-white-arrow-right.svg" alt="Arrow icon">\n          </div>\n        </div>\n        <div class="calculator-modal_final-dropdown-body">\n  \n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Smart Hub</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Пристрій, що буде керувати усіма системами та датчиками.</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$220</div>\n          </div>\n          ${0===securityFunctions?"":`\n               <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Безпека та захист</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${securityFunctionsText.map((a=>a)).join(" ")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${securityFunctions}</div>\n              </div>\n            `}\n          ${0===comfortFunctions?"":`\n              <div class="calculator-modal_final-dropdown-item">\n                <div class="calculator-modal_final-dropdown-item-wrapper">\n                  <div class="calculator-modal_final-dropdown-item-title">Комфорт та продуктивність</div>\n                  <div class="calculator-modal_final-dropdown-item-text text">${comfortFunctionsText.map((a=>a)).join(" ,")}</div>\n                </div>\n                <div class="calculator-modal_final-dropdown-item-value">$${comfortFunctions}</div>\n              </div>\n            `}\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Проектування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Ми узгодимо з вами функції та бюджет і спроектуємо систему та\n                розміщення вузлів розумного будинку. </div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$110</div>\n          </div>\n          <div class="calculator-modal_final-dropdown-item">\n            <div class="calculator-modal_final-dropdown-item-wrapper">\n              <div class="calculator-modal_final-dropdown-item-title">Монтаж та налаштування</div>\n              <div class="calculator-modal_final-dropdown-item-text text">Після схвалення проекту розумного будинку ми встановимо все необхідне\n                обладнання та програмне забезпечення, а також надамо вам детальні інструкції щодо його використання. Вам залишається займатися\n                своїми справами, поки розумний будинок виконує все за вас!</div>\n            </div>\n            <div class="calculator-modal_final-dropdown-item-value">$290-560</div>\n          </div>\n  \n        </div>\n      </div>\n      <p class="calculator-modal_final-text text">Вище наведена лише орієнтована вартість. Вона залежить у першу\n        чергу від виробників пристроїв, бажаних сценаріїв автоматизації, а також складності встановлення\n        обладнання. Ми можемо змінювати вказану суму, адаптуючи її під ваші потреби та можливості, для цього\n        достатньо лише зв'язатися з нами!</p>\n  \n      <form class="calculator-modal_final-form">\n        <div class="calculator-modal_final-form-title">Залиште свій контакт, щоб детальніше дізнатись про встановлення Розумного дому</div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="name" class="label">Імʼя*</label>\n          <input\n            id="name"\n            name="Iмʼя"\n            type="text"\n            class="input"\n            placeholder="Введіть ваше імʼя"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="phone" class="label">Телефон*</label>\n          <input\n            class="input"\n            id="phone"\n            name="Телефон"\n            value="+380"\n            placeholder="+380XXXXXXXXX"\n            type="tel"\n            maxlength="13"\n            pattern="^\\+380[0-9]{9}$"\n            title="Введіть данні в форматі +380XXXXXXXXX"\n            required\n          >\n        </div>\n        <div class="calculator-modal_final-form-group input-group">\n          <label for="email" class="label">Email</label>\n          <input\n            class="input"\n            id="email"\n            name="Email"\n            type="email"\n            placeholder="Введіть ваш email"\n          >\n        </div>\n        <button class="calculator-modal_final-form-submit button blue" type="submit">Звʼяжіться зі мною</button>\n      </form>\n    </div>\n  `),document.querySelector(".calculator-modal__card").classList.add("final-step"),document.querySelector(".calculator-modal_final-dropdown-header").addEventListener("click",(()=>{document.querySelector(".calculator-modal_final-dropdown").classList.toggle("active")})),void document.querySelector(".calculator-modal_final-form").addEventListener("submit",(async a=>{a.preventDefault();const l=new FormData(a.target),t=[...selectedFunctions[0],...selectedFunctions[1]],e=calculatorSections[3].rooms;l.append("Тип приміщення:",selectedSpace.text),l.append("Приблизна вартiсть:",`$${totalPrice}`),l.append("Функції безпеки вартiсть:",`$${securityFunctions}`),l.append("Функції комфорту вартiсть:",`$${comfortFunctions}`),l.append("Функції"," "),t.map((a=>{l.append(a.text,a.quantity)})),l.append("Кімнати"," "),e.map((a=>{l.append(removeBrFromText(a.name),a.value)}));try{await fetch("https://formspree.io/f/mvojazwd",{method:"POST",body:l,headers:{Accept:"application/json"}}),a.target.reset(),document.querySelector(".confirm-modal__backdrop").classList.add("visible")}catch(a){console.log(a)}}));switch(currentTemplate.sectionType){case"choose":a=`\n    <div class="calculator-modal__template choose">\n      <h2 class="calculator-modal__template-title">${(l=currentTemplate).title}</h2>\n      <p class="calculator-modal__template-text text">${l.text}</p>\n      <div class="calculator-modal__template-choose">\n      ${l.variants.map(((a,l)=>`\n          <div onclick="chooseVariant(${l})" class="calculator-modal__template-choose-item ${a.selected?"selected":""}">\n            <img src="${a.icon}" alt="${a.text}">\n            <span>${a.text}</span>\n          </div>\n        `)).join("")}\n      </div>\n      ${l.subtext?`<div class="calculator-modal__template-choose-subtext text">${l.subtext}</div>`:""}\n\n    </div>\n  `;break;case"range":a=rangeTemplate(currentTemplate);break;case"rooms":a=roomsTemplate(currentTemplate)}var l;0===currentStep?prevButton.classList.add("disabled"):prevButton.classList.remove("disabled"),calculatorModalBody.innerHTML=a};nextButton.addEventListener("click",(()=>{("choose"!==currentTemplate.sectionType||currentTemplate.variants.find((a=>!0===a.selected)))&&(calculatorSections[currentStep]=currentTemplate,currentStep++,currentStep<5&&document.querySelector(`.calculator-modal__step.step_${currentStep+1}`).classList.add("active"),renderStep())})),prevButton.addEventListener("click",(()=>{currentStep<5&&document.querySelector(`.calculator-modal__step.step_${currentStep+1}`).classList.remove("active"),currentStep--,renderStep()})),document.querySelector(".functions-page__button.calculator").addEventListener("click",(()=>{calculatorModalBackdrop.classList.toggle("visible"),document.body.classList.toggle("overflow-hidden")})),document.querySelector(".calculator-modal__close").addEventListener("click",(()=>{calculatorModalBackdrop.classList.toggle("visible"),document.body.classList.toggle("overflow-hidden")})),renderStep();